.viz-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* --- Shared message --- */
.viz-msg {
    font-size: 0.78rem;
    color: #a78bfa;
    background: rgba(124, 58, 237, 0.08);
    border: 1px solid rgba(124, 58, 237, 0.2);
    border-radius: var(--r-sm);
    padding: 5px 10px;
    text-align: center;
    min-height: 26px;
}

/* --- Array bars --- */
.array-bars {
    display: flex;
    align-items: flex-end;
    gap: 4px;
    height: 140px;
    background: var(--bg-base);
    border-radius: var(--r-sm);
    padding: 8px;
}

.bar-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    flex: 1;
}

.bar {
    width: 100%;
    border-radius: 3px 3px 0 0;
    background: rgba(124, 58, 237, 0.5);
    border: 1px solid rgba(124, 58, 237, 0.3);
    transition: height 0.22s ease, background 0.18s ease;
    min-height: 6px;
}

.bar-comparing  { background: #f59e0b !important; border-color: #fbbf24 !important; box-shadow: 0 0 8px rgba(245,158,11,0.5); }
.bar-done       { background: rgba(34,197,94,0.6) !important; border-color: rgba(34,197,94,0.4) !important; }
.bar-min        { background: rgba(6,182,212,0.6) !important; border-color: rgba(6,182,212,0.4) !important; }
.bar-key        { background: #f59e0b !important; border-color: #fbbf24 !important; box-shadow: 0 0 8px rgba(245,158,11,0.6); }
.bar-pivot      { background: #ef4444 !important; border-color: #f87171 !important; box-shadow: 0 0 10px rgba(239,68,68,0.5); }
.bar-highlight  { background: rgba(6,182,212,0.5) !important; border-color: rgba(6,182,212,0.4) !important; }

.bar-label { font-size: 0.6rem; color: var(--text-muted); font-family: var(--font-mono); }

.viz-done-label {
    color: var(--easy);
    font-weight: 600;
    text-align: center;
    font-size: 0.82rem;
}

/* --- Search --- */
.search-target { font-size: 0.85rem; color: var(--text-secondary); padding: 4px 0; }
.search-target strong { color: #f59e0b; }
.search-array { display: flex; gap: 4px; flex-wrap: wrap; }

.search-cell {
    display: flex; flex-direction: column; align-items: center; gap: 2px;
    min-width: 32px; padding: 6px 4px;
    border-radius: var(--r-sm); border: 1px solid var(--border);
    background: var(--bg-elevated); transition: all 0.22s ease;
}
.cell-val { font-family: var(--font-mono); font-size: 0.8rem; font-weight: 600; }
.cell-idx { font-size: 0.6rem; color: var(--text-muted); }
.cell-mid { background: rgba(245,158,11,0.2); border-color: #f59e0b; }
.cell-range { background: rgba(124,58,237,0.1); border-color: rgba(124,58,237,0.3); }
.cell-eliminated { opacity: 0.3; }
.cell-found { background: rgba(34,197,94,0.2); border-color: #22c55e; }

/* --- Graph --- */
.graph-svg {
    width: 100%; height: 160px;
    background: var(--bg-base); border-radius: var(--r-sm);
}
.graph-info { display: flex; flex-direction: column; gap: 4px; }
.graph-ds-label { font-size: 0.75rem; color: var(--text-muted); font-family: var(--font-mono); }
.graph-order {
    display: flex; gap: 6px; align-items: center; flex-wrap: wrap;
    font-size: 0.78rem; color: var(--text-secondary);
}
.graph-order-node {
    padding: 2px 8px; border-radius: 999px;
    background: rgba(124,58,237,0.2); border: 1px solid rgba(124,58,237,0.4);
    color: #a78bfa; font-weight: 600; font-family: var(--font-mono);
}

/* --- DP --- */
.dp-label { font-size: 0.8rem; color: var(--text-muted); }
.dp-table { display: flex; gap: 4px; flex-wrap: wrap; }
.dp-cell {
    display: flex; flex-direction: column; align-items: center; gap: 2px;
    padding: 8px 6px; min-width: 36px;
    border-radius: var(--r-sm); border: 1px solid var(--border);
    background: var(--bg-elevated); transition: all 0.3s ease;
}
.dp-filled { background: rgba(124,58,237,0.15); border-color: rgba(124,58,237,0.4); }
.dp-current { background: rgba(124,58,237,0.3); border-color: #7c3aed; box-shadow: 0 0 12px rgba(124,58,237,0.4); }
.dp-val { font-family: var(--font-mono); font-size: 0.82rem; font-weight: 700; }
.dp-idx { font-size: 0.6rem; color: var(--text-muted); }
.dp-formula {
    font-size: 0.78rem; color: var(--text-secondary);
    background: var(--bg-elevated); padding: 8px 12px;
    border-radius: var(--r-sm); font-family: var(--font-mono);
}
.dp-formula strong { color: #a78bfa; }

/* --- Stack --- */
.stack-viz { display: flex; gap: 20px; align-items: flex-start; }
.stack-column {
    display: flex; flex-direction: column-reverse; gap: 4px;
    min-width: 80px; min-height: 120px;
    justify-content: flex-start; align-items: center;
}
.stack-item {
    width: 76px; padding: 8px;
    background: rgba(124,58,237,0.25); border: 1px solid rgba(124,58,237,0.5);
    border-radius: var(--r-sm);
    display: flex; align-items: center; justify-content: center; gap: 6px;
    font-family: var(--font-mono); font-weight: 700; font-size: 0.9rem;
    position: relative; transition: all 0.25s ease;
}
.stack-top { background: rgba(124,58,237,0.5); border-color: #7c3aed; }
.stack-top-label { position: absolute; left: -38px; font-size: 0.65rem; color: #a78bfa; }
.stack-empty { color: var(--text-muted); font-size: 0.8rem; margin: auto; }
.stack-ops { display: flex; flex-direction: column; gap: 4px; flex: 1; }
.stack-op {
    padding: 5px 10px; border-radius: var(--r-sm);
    font-family: var(--font-mono); font-size: 0.75rem;
    color: var(--text-muted); border: 1px solid transparent; transition: all 0.2s;
}
.stack-op-active { color: #a78bfa; border-color: rgba(124,58,237,0.5); background: rgba(124,58,237,0.1); }
.stack-op-done { opacity: 0.35; }

/* --- Queue --- */
.queue-viz { display: flex; flex-direction: column; gap: 4px; }
.queue-labels { display: flex; font-size: 0.65rem; color: var(--text-muted); padding: 0 2px; }
.queue-row { display: flex; gap: 4px; min-height: 52px; align-items: center; }
.queue-item {
    min-width: 42px; padding: 10px 8px;
    background: rgba(6,182,212,0.15); border: 1px solid rgba(6,182,212,0.35);
    border-radius: var(--r-sm);
    display: flex; align-items: center; justify-content: center;
    font-family: var(--font-mono); font-weight: 700; font-size: 0.9rem;
    transition: all 0.25s ease;
}
.queue-front { background: rgba(6,182,212,0.35); border-color: #06b6d4; box-shadow: 0 0 8px rgba(6,182,212,0.4); }
.queue-rear  { background: rgba(124,58,237,0.3); border-color: #7c3aed; }
.queue-empty { color: var(--text-muted); font-size: 0.8rem; }
.queue-arrows { display: flex; justify-content: space-between; font-size: 0.65rem; color: var(--text-muted); }
.queue-ops-strip { display: flex; gap: 4px; flex-wrap: wrap; }
.queue-op {
    padding: 3px 8px; border-radius: var(--r-sm);
    font-family: var(--font-mono); font-size: 0.72rem;
    color: var(--text-muted); border: 1px solid transparent; transition: all 0.2s;
}
.queue-op-active { color: #38bdf8; border-color: rgba(6,182,212,0.5); background: rgba(6,182,212,0.1); }
.queue-op-done { opacity: 0.35; }

/* --- Hash Table --- */
.hash-grid { display: flex; flex-direction: column; gap: 4px; }
.hash-bucket {
    display: flex; align-items: center; gap: 8px;
    padding: 5px 8px; border-radius: var(--r-sm);
    border: 1px solid var(--border); background: var(--bg-elevated);
    transition: all 0.25s ease;
}
.hash-bucket-active { border-color: #f59e0b; background: rgba(245,158,11,0.08); }
.hash-idx { font-family: var(--font-mono); font-size: 0.72rem; color: var(--text-muted); min-width: 24px; }
.hash-chain { display: flex; gap: 4px; align-items: center; flex-wrap: wrap; }
.hash-pair { font-family: var(--font-mono); font-size: 0.75rem; color: var(--text-secondary); }
.hash-pair em { color: #a78bfa; font-style: normal; }
.hash-arrow { color: var(--text-muted); margin: 0 2px; }
.hash-empty { color: var(--text-muted); font-size: 0.72rem; }

/* --- Binary Tree --- */
.tree-svg {
    width: 100%; height: 140px;
    background: var(--bg-base); border-radius: var(--r-sm);
}
.tree-tabs { display: flex; gap: 6px; }
.tree-tab {
    padding: 4px 12px; border-radius: var(--r-sm);
    border: 1px solid var(--border); background: var(--bg-elevated);
    color: var(--text-secondary); font-size: 0.78rem; cursor: pointer;
    transition: all var(--t-fast);
}
.tree-tab.active { border-color: #7c3aed; color: #a78bfa; background: rgba(124,58,237,0.15); }
.tree-tab:hover:not(.active) { border-color: var(--border-hover); color: var(--text-primary); }

/* --- Controls wrapper --- */
.viz-controls-wrap { display: flex; flex-direction: column; gap: 6px; }

/* --- Speed control --- */
.viz-speed { display: flex; gap: 4px; justify-content: center; }
.speed-btn {
    padding: 2px 10px; border-radius: 999px;
    border: 1px solid var(--border); background: var(--bg-elevated);
    color: var(--text-muted); font-size: 0.72rem; cursor: pointer;
    transition: all var(--t-fast);
}
.speed-btn.active { border-color: #7c3aed; color: #a78bfa; background: rgba(124,58,237,0.15); }
.speed-btn:hover:not(.active) { border-color: var(--border-hover); color: var(--text-primary); }

/* --- Progress --- */
.viz-progress { height: 3px; background: var(--bg-elevated); border-radius: 2px; overflow: hidden; }
.viz-progress-bar { height: 100%; background: var(--gradient); border-radius: 2px; transition: width 0.22s ease; }
.viz-step-label { font-size: 0.75rem; color: var(--text-muted); text-align: center; }

/* --- Controls --- */
.viz-controls { display: flex; gap: 8px; justify-content: center; align-items: center; }
.viz-btn {
    width: 32px; height: 32px; border-radius: 50%;
    border: 1px solid var(--border); background: var(--bg-elevated);
    color: var(--text-secondary); cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.75rem; transition: all var(--t-fast);
}
.viz-btn:hover:not(:disabled) { border-color: var(--border-hover); color: var(--text-primary); background: var(--bg-surface); }
.viz-btn:disabled { opacity: 0.35; cursor: not-allowed; }
.viz-btn-play { width: 40px; height: 40px; background: var(--gradient); border-color: transparent; color: white; font-size: 0.9rem; box-shadow: 0 0 12px rgba(124,58,237,0.4); }
.viz-btn-play:hover:not(:disabled) { box-shadow: 0 0 20px rgba(124,58,237,0.6); }

/* --- Legend --- */
.viz-legend { display: flex; gap: 12px; justify-content: center; font-size: 0.72rem; color: var(--text-muted); flex-wrap: wrap; }
.legend-item { display: flex; align-items: center; gap: 4px; }
.legend-dot { width: 8px; height: 8px; border-radius: 2px; }
.dot-default   { background: rgba(124,58,237,0.4); }
.dot-comparing { background: #f59e0b; }
.dot-done      { background: #22c55e; }
.dot-pivot     { background: #ef4444; }